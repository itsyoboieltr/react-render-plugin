{"version":3,"file":"react-render-plugin.min.js","sources":["../src/utils.js","../src/Control.jsx","../src/Socket.jsx","../src/Node.jsx","../src/index.jsx"],"sourcesContent":["export function kebab(str) {\n    const replace = s => s.toLowerCase().replace(/ /g, '-');\n\n    return Array.isArray(str) ? str.map(replace) : replace(str);\n}","/* eslint-disable react/prop-types */\nimport React from 'react';\n\nexport class Control extends React.Component {\n    createRef = el => {\n        const { innerRef, control } = this.props;\n    \n        el && innerRef(el, control);\n    };\n\n    render() {\n        const { className, control } = this.props;\n\n        return (\n            <div\n                className={className}\n                title={control.key}\n                ref={this.createRef}\n            />\n        )\n    }\n}","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { kebab } from './utils';\n\nexport class Socket extends React.Component {\n    createRef = el => {\n        const { innerRef, type, io } = this.props;\n    \n        el && innerRef(el, type, io);\n    };\n\n    render () {\n        const { socket, type } = this.props;\n\n        return (\n            <div\n                className={`socket ${type} ${kebab(socket.name)}`}\n                title={socket.name}\n                ref={el => this.createRef(el)} // force update for new IO with a same key \n            />\n        )\n    }\n}","/* eslint-disable sort-imports */\n/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { kebab } from './utils';\nimport { Control } from './Control';\nimport { Socket } from './Socket';\n\nexport class Node extends React.Component {\n    state = {}\n\n    static getDerivedStateFromProps({ node, editor }) {\n        return {\n            outputs: Array.from(node.outputs.values()),\n            controls: Array.from(node.controls.values()),\n            inputs: Array.from(node.inputs.values()),\n            selected: editor.selected.contains(node) ? 'selected' : ''\n        }\n    }\n    \n    render() {\n        const { node, bindSocket, bindControl } = this.props;\n        const { outputs, controls, inputs, selected } = this.state;\n\n        return (\n            <div className={`node ${selected} ${kebab(node.name)}`}>\n                <div className=\"title\">{node.name}</div>\n                {/* Outputs */}\n                {outputs.map((output) => (\n                    <div className=\"output\" key={output.key}>\n                        <div className=\"output-title\">{output.name}</div>\n                        <Socket type=\"output\" socket={output.socket} io={output} innerRef={bindSocket} />\n                    </div>\n                ))}\n                {/* Controls */}\n                {controls.map(control => (\n                    <Control className=\"control\" key={control.key} control={control} innerRef={bindControl} />\n                ))}\n                {/* Inputs */}\n                {inputs.map(input => (\n                    <div className=\"input\" key={input.key}>\n                        <Socket type=\"input\" socket={input.socket} io={input} innerRef={bindSocket} />\n                        {!input.showControl() && <div className=\"input-title\">{input.name}</div>}\n                        {input.showControl() && <Control className=\"input-control\" control={input.control} innerRef={bindControl} />}\n                    </div>\n                ))}\n            </div>\n        )\n    }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Node } from './Node';\n\nfunction install(editor, { component: NodeComponent = Node, doInsertDefaultNodeStyles = true }) {\n    if(doInsertDefaultNodeStyles === true) {\n        require('./styles.sass');\n    }\n\n    editor.on('rendernode', ({ el, node, component, bindSocket, bindControl }) => {\n        if (component.render && component.render !== 'react') return;\n        const Component = component.component || NodeComponent;\n\n        node.update = () => new Promise((res) => {\n            ReactDOM.render(<Component node={node} editor={editor} bindSocket={bindSocket} bindControl={bindControl} />, el, res)\n        });\n        node._reactComponent = true;\n        node.update();\n    });\n\n    editor.on('rendercontrol', ({ el, control }) => {\n        if (control.render && control.render !== 'react') return;\n        const Component = control.component;\n\n        control.update = () => new Promise((res) => {\n            ReactDOM.render(<Component {...control.props} />, el, res)\n        });\n        control.update();\n    });\n\n    editor.on('connectioncreated connectionremoved', connection => {\n        connection.output.node.update();\n        connection.input.node.update();\n    });\n\n    editor.on('nodeselected', () => {\n        editor.nodes.filter(n => n._reactComponent).map(node => node.update());\n    });\n}\n\nexport { Node } from './Node';\nexport { Socket } from './Socket';\nexport { Control } from './Control';\n\nexport default {\n    name: 'react-render',\n    install\n}\n"],"names":["kebab","str","replace","s","toLowerCase","Array","isArray","map","Control","React","Component","el","_this","props","innerRef","control","this","className","title","key","ref","createRef","Socket","type","io","socket","name","_this2","Node","node","bindSocket","bindControl","state","outputs","controls","inputs","selected","output","input","showControl","editor","from","values","contains","install","component","NodeComponent","doInsertDefaultNodeStyles","require","on","render","update","Promise","res","ReactDOM","_reactComponent","connection","nodes","filter","n"],"mappings":"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"}