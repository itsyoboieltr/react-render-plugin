{"version":3,"file":"react-render-plugin.common.js","sources":["../src/utils.js","../src/Control.jsx","../src/Socket.jsx","../src/Node.jsx","../src/index.jsx"],"sourcesContent":["export function kebab(str) {\n    const replace = s => s.toLowerCase().replace(/ /g, '-');\n\n    return Array.isArray(str) ? str.map(replace) : replace(str);\n}","/* eslint-disable react/prop-types */\nimport React from 'react';\n\nexport class Control extends React.Component {\n    createRef = el => {\n        const { innerRef, control } = this.props;\n    \n        el && innerRef(el, control);\n    };\n\n    render() {\n        const { className, control } = this.props;\n\n        return (\n            <div\n                className={className}\n                title={control.key}\n                ref={this.createRef}\n            />\n        )\n    }\n}","/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { kebab } from './utils';\n\nexport class Socket extends React.Component {\n    createRef = el => {\n        const { innerRef, type, io } = this.props;\n    \n        el && innerRef(el, type, io);\n    };\n\n    render () {\n        const { socket, type } = this.props;\n\n        return (\n            <div\n                className={`socket ${type} ${kebab(socket.name)}`}\n                title={socket.name}\n                ref={el => this.createRef(el)} // force update for new IO with a same key \n            />\n        )\n    }\n}","/* eslint-disable sort-imports */\n/* eslint-disable react/prop-types */\nimport React from 'react';\nimport { kebab } from './utils';\nimport { Control } from './Control';\nimport { Socket } from './Socket';\n\nexport class Node extends React.Component {\n    state = {}\n\n    static getDerivedStateFromProps({ node, editor }) {\n        return {\n            outputs: Array.from(node.outputs.values()),\n            controls: Array.from(node.controls.values()),\n            inputs: Array.from(node.inputs.values()),\n            selected: editor.selected.contains(node) ? 'selected' : ''\n        }\n    }\n    \n    render() {\n        const { node, bindSocket, bindControl } = this.props;\n        const { outputs, controls, inputs, selected } = this.state;\n\n        return (\n            <div className={`node ${selected} ${kebab(node.name)}`}>\n                <div className=\"title\">{node.name}</div>\n                {/* Outputs */}\n                {outputs.map((output) => (\n                    <div className=\"output\" key={output.key}>\n                        <div className=\"output-title\">{output.name}</div>\n                        <Socket type=\"output\" socket={output.socket} io={output} innerRef={bindSocket} />\n                    </div>\n                ))}\n                {/* Controls */}\n                {controls.map(control => (\n                    <Control className=\"control\" key={control.key} control={control} innerRef={bindControl} />\n                ))}\n                {/* Inputs */}\n                {inputs.map(input => (\n                    <div className=\"input\" key={input.key}>\n                        <Socket type=\"input\" socket={input.socket} io={input} innerRef={bindSocket} />\n                        {!input.showControl() && <div className=\"input-title\">{input.name}</div>}\n                        {input.showControl() && <Control className=\"input-control\" control={input.control} innerRef={bindControl} />}\n                    </div>\n                ))}\n            </div>\n        )\n    }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Node } from './Node';\n\nfunction install(editor, { component: NodeComponent = Node, doInsertDefaultNodeStyles = true }) {\n    if(doInsertDefaultNodeStyles === true) {\n        require('./styles.sass');\n    }\n\n    editor.on('rendernode', ({ el, node, component, bindSocket, bindControl }) => {\n        if (component.render && component.render !== 'react') return;\n        const Component = component.component || NodeComponent;\n\n        node.update = () => new Promise((res) => {\n            ReactDOM.render(<Component node={node} editor={editor} bindSocket={bindSocket} bindControl={bindControl} />, el, res)\n        });\n        node._reactComponent = true;\n        node.update();\n    });\n\n    editor.on('rendercontrol', ({ el, control }) => {\n        if (control.render && control.render !== 'react') return;\n        const Component = control.component;\n\n        control.update = () => new Promise((res) => {\n            ReactDOM.render(<Component {...control.props} />, el, res)\n        });\n        control.update();\n    });\n\n    editor.on('connectioncreated connectionremoved', connection => {\n        connection.output.node.update();\n        connection.input.node.update();\n    });\n\n    editor.on('nodeselected', () => {\n        editor.nodes.filter(n => n._reactComponent).map(node => node.update());\n    });\n}\n\nexport { Node } from './Node';\nexport { Socket } from './Socket';\nexport { Control } from './Control';\n\nexport default {\n    name: 'react-render',\n    install\n}\n"],"names":["kebab","str","replace","s","toLowerCase","Array","isArray","map","Control","el","props","innerRef","control","className","key","createRef","React","Component","Socket","type","io","socket","name","Node","node","bindSocket","bindControl","state","outputs","controls","inputs","selected","output","input","showControl","editor","from","values","contains","install","component","NodeComponent","doInsertDefaultNodeStyles","require","on","render","update","Promise","res","ReactDOM","_reactComponent","connection","nodes","filter","n"],"mappings":"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"}